<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml" lang="" xml:lang="">

<head>
  <meta charset="utf-8"/>
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta http-equiv="X-UA-Compatible" content="IE=Edge,chrome=1"/>
  <meta name="generator" content="distill" />

  <style type="text/css">
  /* Hide doc at startup (prevent jankiness while JS renders/transforms) */
  body {
    visibility: hidden;
  }
  </style>

 <!--radix_placeholder_import_source-->
 <!--/radix_placeholder_import_source-->

  <!--radix_placeholder_meta_tags-->
  <title>Dinâmica do coronavirus em Portugal</title>
  
  
  <link rel="license" href="https://creativecommons.org/licenses/by-sa/4.0/"/>
  
  <!--  https://schema.org/Article -->
  <meta property="article:published" itemprop="datePublished" content="2020-04-30"/>
  <meta property="article:created" itemprop="dateCreated" content="2020-04-30"/>
  <meta name="article:author" content="Humberto Silva"/>
  
  <!--  https://developers.facebook.com/docs/sharing/webmasters#markup -->
  <meta property="og:title" content="Dinâmica do coronavirus em Portugal"/>
  <meta property="og:type" content="article"/>
  <meta property="og:image" content="https://science4u.github.io/blog/2020-04-30-coronavirus_files/figure-html5/infected-1.png"/>
  <meta property="og:image:width" content="1248"/>
  <meta property="og:image:height" content="768"/>
  <meta property="og:locale" content="en_US"/>
  
  <!--  https://dev.twitter.com/cards/types/summary -->
  <meta property="twitter:card" content="summary_large_image"/>
  <meta property="twitter:title" content="Dinâmica do coronavirus em Portugal"/>
  <meta property="twitter:image" content="https://science4u.github.io/blog/2020-04-30-coronavirus_files/figure-html5/infected-1.png"/>
  <meta property="twitter:image:width" content="1248"/>
  <meta property="twitter:image:height" content="768"/>
  
  <!--/radix_placeholder_meta_tags-->
  <!--radix_placeholder_rmarkdown_metadata-->
  
  <script type="text/json" id="radix-rmarkdown-metadata">
  {"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["layout","subheadline","title","teaser","categories","tags","header","image","author","creative_commons","date","base_url","slug","output","repository_url"]}},"value":[{"type":"character","attributes":{},"value":["page"]},{"type":"character","attributes":{},"value":["30-04-2020 - Humberto Silva"]},{"type":"character","attributes":{},"value":["Dinâmica do coronavirus em Portugal"]},{"type":"character","attributes":{},"value":["Modelando os dados da epidemia em Portugal com o software R"]},{"type":"character","attributes":{},"value":["science"]},{"type":"character","attributes":{},"value":["coronavirus","Portugal","R"]},{"type":"logical","attributes":{},"value":[false]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["title","caption","caption_url"]}},"value":[{"type":"character","attributes":{},"value":["sars_cov_2.jpg"]},{"type":"character","attributes":{},"value":["This is a caption for the header image with link"]},{"type":"character","attributes":{},"value":["https://unsplash.com/"]}]},{"type":"list","attributes":{},"value":[{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["name"]}},"value":[{"type":"character","attributes":{},"value":["Humberto Silva"]}]}]},{"type":"character","attributes":{},"value":["CC BY-SA"]},{"type":"character","attributes":{},"value":["2020-04-30"]},{"type":"character","attributes":{},"value":["https://science4u.github.io/blog/"]},{"type":"character","attributes":{},"value":["silvahumberto2020covid19"]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["distill::distill_article"]}},"value":[{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["toc","toc_depth","self_contained"]}},"value":[{"type":"logical","attributes":{},"value":[true]},{"type":"integer","attributes":{},"value":[2]},{"type":"logical","attributes":{},"value":[false]}]}]},{"type":"character","attributes":{},"value":["https://github.com/science4u/science4u.github.io/tree/master/_posts/design/"]}]}
  </script>
  <!--/radix_placeholder_rmarkdown_metadata-->
  
  <script type="text/json" id="radix-resource-manifest">
  {"type":"character","attributes":{},"value":["2020-04-30-coronavirus_files/bowser-1.9.3/bowser.min.js","2020-04-30-coronavirus_files/distill-2.2.21/template.v2.js","2020-04-30-coronavirus_files/figure-html/infected-1.png","2020-04-30-coronavirus_files/figure-html/optimization2-1.png","2020-04-30-coronavirus_files/figure-html/pressure-1.png","2020-04-30-coronavirus_files/figure-html/pressure-2.png","2020-04-30-coronavirus_files/figure-html/sars_cov_2.jpg","2020-04-30-coronavirus_files/figure-html5/infected-1.png","2020-04-30-coronavirus_files/figure-html5/optimization2-1.png","2020-04-30-coronavirus_files/figure-html5/pressure-1.png","2020-04-30-coronavirus_files/figure-html5/pressure-2.png","2020-04-30-coronavirus_files/jquery-1.11.3/jquery.min.js","2020-04-30-coronavirus_files/webcomponents-2.0.0/webcomponents.js"]}
  </script>
  <!--radix_placeholder_navigation_in_header-->
  <!--/radix_placeholder_navigation_in_header-->
  <!--radix_placeholder_distill-->
  
  <style type="text/css">
  
  body {
    background-color: white;
  }
  
  .pandoc-table {
    width: 100%;
  }
  
  .pandoc-table>caption {
    margin-bottom: 10px;
  }
  
  .pandoc-table th:not([align]) {
    text-align: left;
  }
  
  .pagedtable-footer {
    font-size: 15px;
  }
  
  .html-widget {
    margin-bottom: 2.0em;
  }
  
  .l-screen-inset {
    padding-right: 16px;
  }
  
  .l-screen .caption {
    margin-left: 10px;
  }
  
  .shaded {
    background: rgb(247, 247, 247);
    padding-top: 20px;
    padding-bottom: 20px;
    border-top: 1px solid rgba(0, 0, 0, 0.1);
    border-bottom: 1px solid rgba(0, 0, 0, 0.1);
  }
  
  .shaded .html-widget {
    margin-bottom: 0;
    border: 1px solid rgba(0, 0, 0, 0.1);
  }
  
  .shaded .shaded-content {
    background: white;
  }
  
  .text-output {
    margin-top: 0;
    line-height: 1.5em;
  }
  
  .hidden {
    display: none !important;
  }
  
  d-article {
    padding-bottom: 30px;
  }
  
  d-appendix {
    padding-top: 30px;
  }
  
  d-article>p>img {
    width: 100%;
  }
  
  d-article iframe {
    border: 1px solid rgba(0, 0, 0, 0.1);
    margin-bottom: 2.0em;
    width: 100%;
  }
  
  figure img.external {
    background: white;
    border: 1px solid rgba(0, 0, 0, 0.1);
    box-shadow: 0 1px 8px rgba(0, 0, 0, 0.1);
    padding: 18px;
    box-sizing: border-box;
  }
  
  /* CSS for table of contents */
  
  .d-toc {
    color: rgba(0,0,0,0.8);
    font-size: 0.8em;
    line-height: 1em;
  }
  
  .d-toc-header {
    font-size: 0.6rem;
    font-weight: 400;
    color: rgba(0, 0, 0, 0.5);
    text-transform: uppercase;
    margin-top: 0;
    margin-bottom: 1.3em;
  }
  
  .d-toc a {
    border-bottom: none;
  }
  
  .d-toc ul {
    padding-left: 0;
  }
  
  .d-toc li>ul {
    padding-top: 0.8em;
    padding-left: 16px;
    margin-bottom: 0.6em;
  }
  
  .d-toc ul,
  .d-toc li {
    list-style-type: none;
  }
  
  .d-toc li {
    margin-bottom: 0.9em;
  }
  
  .d-toc-separator {
    margin-top: 20px;
    margin-bottom: 2em;
  }
  
  .d-article-with-toc {
    border-top: none;
    padding-top: 0;
  }
  
  
  
  /* Tweak code blocks (note that this CSS is repeated above in an injection
     into the d-code shadow dom) */
  
  d-code {
    overflow-x: auto !important;
  }
  
  pre.d-code code.d-code {
    padding-left: 10px;
    font-size: 12px;
    border-left: 2px solid rgba(0,0,0,0.1);
  }
  
  pre.text-output {
  
    font-size: 12px;
    color: black;
    background: none;
    font-family: Consolas, Monaco, 'Andale Mono', 'Ubuntu Mono', monospace;
    text-align: left;
    white-space: pre;
    word-spacing: normal;
    word-break: normal;
    word-wrap: normal;
    line-height: 1.5;
  
    -moz-tab-size: 4;
    -o-tab-size: 4;
    tab-size: 4;
  
    -webkit-hyphens: none;
    -moz-hyphens: none;
    -ms-hyphens: none;
    hyphens: none;
  }
  
  @media(min-width: 768px) {
  
  d-code {
    overflow-x: visible !important;
  }
  
  pre.d-code code.d-code  {
      padding-left: 18px;
      font-size: 14px;
  }
  pre.text-output {
    font-size: 14px;
  }
  }
  
  /* Figure */
  
  .figure {
    position: relative;
    margin-bottom: 2.5em;
    margin-top: 1.5em;
  }
  
  .figure img {
    width: 100%;
  }
  
  .figure .caption {
    color: rgba(0, 0, 0, 0.6);
    font-size: 12px;
    line-height: 1.5em;
  }
  
  .figure img.external {
    background: white;
    border: 1px solid rgba(0, 0, 0, 0.1);
    box-shadow: 0 1px 8px rgba(0, 0, 0, 0.1);
    padding: 18px;
    box-sizing: border-box;
  }
  
  .figure .caption a {
    color: rgba(0, 0, 0, 0.6);
  }
  
  .figure .caption b,
  .figure .caption strong, {
    font-weight: 600;
    color: rgba(0, 0, 0, 1.0);
  }
  
  
  
  /* Tweak 1000px media break to show more text */
  
  @media(min-width: 1000px) {
    .base-grid,
    distill-header,
    d-title,
    d-abstract,
    d-article,
    d-appendix,
    distill-appendix,
    d-byline,
    d-footnote-list,
    d-citation-list,
    distill-footer {
      grid-template-columns: [screen-start] 1fr [page-start kicker-start] 80px [middle-start] 50px [text-start kicker-end] 65px 65px 65px 65px 65px 65px 65px 65px [text-end gutter-start] 65px [middle-end] 65px [page-end gutter-end] 1fr [screen-end];
      grid-column-gap: 16px;
    }
  
    .grid {
      grid-column-gap: 16px;
    }
  
    d-article {
      font-size: 1.06rem;
      line-height: 1.7em;
    }
    figure .caption, .figure .caption, figure figcaption {
      font-size: 13px;
    }
  }
  
  @media(min-width: 1180px) {
    .base-grid,
    distill-header,
    d-title,
    d-abstract,
    d-article,
    d-appendix,
    distill-appendix,
    d-byline,
    d-footnote-list,
    d-citation-list,
    distill-footer {
      grid-template-columns: [screen-start] 1fr [page-start kicker-start] 60px [middle-start] 60px [text-start kicker-end] 60px 60px 60px 60px 60px 60px 60px 60px [text-end gutter-start] 60px [middle-end] 60px [page-end gutter-end] 1fr [screen-end];
      grid-column-gap: 32px;
    }
  
    .grid {
      grid-column-gap: 32px;
    }
  }
  
  
  /* Get the citation styles for the appendix (not auto-injected on render since
     we do our own rendering of the citation appendix) */
  
  d-appendix .citation-appendix,
  .d-appendix .citation-appendix {
    font-size: 11px;
    line-height: 15px;
    border-left: 1px solid rgba(0, 0, 0, 0.1);
    padding-left: 18px;
    border: 1px solid rgba(0,0,0,0.1);
    background: rgba(0, 0, 0, 0.02);
    padding: 10px 18px;
    border-radius: 3px;
    color: rgba(150, 150, 150, 1);
    overflow: hidden;
    margin-top: -12px;
    white-space: pre-wrap;
    word-wrap: break-word;
  }
  
  
  /* Social footer */
  
  .social_footer {
    margin-top: 30px;
    margin-bottom: 0;
    color: rgba(0,0,0,0.67);
  }
  
  .disqus-comments {
    margin-right: 30px;
  }
  
  .disqus-comment-count {
    border-bottom: 1px solid rgba(0, 0, 0, 0.4);
    cursor: pointer;
  }
  
  #disqus_thread {
    margin-top: 30px;
  }
  
  .article-sharing a {
    border-bottom: none;
    margin-right: 8px;
  }
  
  .article-sharing a:hover {
    border-bottom: none;
  }
  
  .sidebar-section.subscribe {
    font-size: 12px;
    line-height: 1.6em;
  }
  
  .subscribe p {
    margin-bottom: 0.5em;
  }
  
  
  .article-footer .subscribe {
    font-size: 15px;
    margin-top: 45px;
  }
  
  
  /* Improve display for browsers without grid (IE/Edge <= 15) */
  
  .downlevel {
    line-height: 1.6em;
    font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Oxygen, Ubuntu, Cantarell, "Fira Sans", "Droid Sans", "Helvetica Neue", Arial, sans-serif;
    margin: 0;
  }
  
  .downlevel .d-title {
    padding-top: 6rem;
    padding-bottom: 1.5rem;
  }
  
  .downlevel .d-title h1 {
    font-size: 50px;
    font-weight: 700;
    line-height: 1.1em;
    margin: 0 0 0.5rem;
  }
  
  .downlevel .d-title p {
    font-weight: 300;
    font-size: 1.2rem;
    line-height: 1.55em;
    margin-top: 0;
  }
  
  .downlevel .d-byline {
    padding-top: 0.8em;
    padding-bottom: 0.8em;
    font-size: 0.8rem;
    line-height: 1.8em;
  }
  
  .downlevel .section-separator {
    border: none;
    border-top: 1px solid rgba(0, 0, 0, 0.1);
  }
  
  .downlevel .d-article {
    font-size: 1.06rem;
    line-height: 1.7em;
    padding-top: 1rem;
    padding-bottom: 2rem;
  }
  
  
  .downlevel .d-appendix {
    padding-left: 0;
    padding-right: 0;
    max-width: none;
    font-size: 0.8em;
    line-height: 1.7em;
    margin-bottom: 0;
    color: rgba(0,0,0,0.5);
    padding-top: 40px;
    padding-bottom: 48px;
  }
  
  .downlevel .footnotes ol {
    padding-left: 13px;
  }
  
  .downlevel .base-grid,
  .downlevel .distill-header,
  .downlevel .d-title,
  .downlevel .d-abstract,
  .downlevel .d-article,
  .downlevel .d-appendix,
  .downlevel .distill-appendix,
  .downlevel .d-byline,
  .downlevel .d-footnote-list,
  .downlevel .d-citation-list,
  .downlevel .distill-footer,
  .downlevel .appendix-bottom,
  .downlevel .posts-container {
    padding-left: 40px;
    padding-right: 40px;
  }
  
  @media(min-width: 768px) {
    .downlevel .base-grid,
    .downlevel .distill-header,
    .downlevel .d-title,
    .downlevel .d-abstract,
    .downlevel .d-article,
    .downlevel .d-appendix,
    .downlevel .distill-appendix,
    .downlevel .d-byline,
    .downlevel .d-footnote-list,
    .downlevel .d-citation-list,
    .downlevel .distill-footer,
    .downlevel .appendix-bottom,
    .downlevel .posts-container {
    padding-left: 150px;
    padding-right: 150px;
    max-width: 900px;
  }
  }
  
  .downlevel pre code {
    display: block;
    border-left: 2px solid rgba(0, 0, 0, .1);
    padding: 0 0 0 20px;
    font-size: 14px;
  }
  
  .downlevel code, .downlevel pre {
    color: black;
    background: none;
    font-family: Consolas, Monaco, 'Andale Mono', 'Ubuntu Mono', monospace;
    text-align: left;
    white-space: pre;
    word-spacing: normal;
    word-break: normal;
    word-wrap: normal;
    line-height: 1.5;
  
    -moz-tab-size: 4;
    -o-tab-size: 4;
    tab-size: 4;
  
    -webkit-hyphens: none;
    -moz-hyphens: none;
    -ms-hyphens: none;
    hyphens: none;
  }
  
  </style>
  
  <script type="application/javascript">
  
  function is_downlevel_browser() {
    if (bowser.isUnsupportedBrowser({ msie: "12", msedge: "16"},
                                   window.navigator.userAgent)) {
      return true;
    } else {
      return window.load_distill_framework === undefined;
    }
  }
  
  // show body when load is complete
  function on_load_complete() {
  
    // set body to visible
    document.body.style.visibility = 'visible';
  
    // force redraw for leaflet widgets
    if (window.HTMLWidgets) {
      var maps = window.HTMLWidgets.findAll(".leaflet");
      $.each(maps, function(i, el) {
        var map = this.getMap();
        map.invalidateSize();
        map.eachLayer(function(layer) {
          if (layer instanceof L.TileLayer)
            layer.redraw();
        });
      });
    }
  
    // trigger 'shown' so htmlwidgets resize
    $('d-article').trigger('shown');
  }
  
  function init_distill() {
  
    init_common();
  
    // create front matter
    var front_matter = $('<d-front-matter></d-front-matter>');
    $('#distill-front-matter').wrap(front_matter);
  
    // create d-title
    $('.d-title').changeElementType('d-title');
  
    // create d-byline
    var byline = $('<d-byline></d-byline>');
    $('.d-byline').replaceWith(byline);
  
    // create d-article
    var article = $('<d-article></d-article>');
    $('.d-article').wrap(article).children().unwrap();
  
    // move posts container into article
    $('.posts-container').appendTo($('d-article'));
  
    // create d-appendix
    $('.d-appendix').changeElementType('d-appendix');
  
    // create d-bibliography
    var bibliography = $('<d-bibliography></d-bibliography>');
    $('#distill-bibliography').wrap(bibliography);
  
    // flag indicating that we have appendix items
    var appendix = $('.appendix-bottom').children('h3').length > 0;
  
    // replace citations with <d-cite>
    $('.citation').each(function(i, val) {
      appendix = true;
      var cites = $(this).attr('data-cites').split(" ");
      var dt_cite = $('<d-cite></d-cite>');
      dt_cite.attr('key', cites.join());
      $(this).replaceWith(dt_cite);
    });
    // remove refs
    $('#refs').remove();
  
    // replace footnotes with <d-footnote>
    $('.footnote-ref').each(function(i, val) {
      appendix = true;
      var href = $(this).attr('href');
      var id = href.replace('#', '');
      var fn = $('#' + id);
      var fn_p = $('#' + id + '>p');
      fn_p.find('.footnote-back').remove();
      var text = fn_p.html();
      var dtfn = $('<d-footnote></d-footnote>');
      dtfn.html(text);
      $(this).replaceWith(dtfn);
    });
    // remove footnotes
    $('.footnotes').remove();
  
    $('h1.appendix, h2.appendix').each(function(i, val) {
      $(this).changeElementType('h3');
    });
    $('h3.appendix').each(function(i, val) {
      var id = $(this).attr('id');
      $('.d-toc a[href="#' + id + '"]').parent().remove();
      appendix = true;
      $(this).nextUntil($('h1, h2, h3')).addBack().appendTo($('d-appendix'));
    });
  
    // show d-appendix if we have appendix content
    $("d-appendix").css('display', appendix ? 'grid' : 'none');
  
    // replace code blocks with d-code
    $('pre>code').each(function(i, val) {
      var code = $(this);
      var pre = code.parent();
      var clz = "";
      var language = pre.attr('class');
      if (language) {
        // map unknown languages to "clike" (without this they just dissapear)
        if ($.inArray(language, ["bash", "clike", "css", "go", "html",
                                 "javascript", "js", "julia", "lua", "markdown",
                                 "markup", "mathml", "python", "svg", "xml"]) == -1)
          language = "clike";
        language = ' language="' + language + '"';
        var dt_code = $('<d-code block' + language + clz + '></d-code>');
        dt_code.text(code.text());
        pre.replaceWith(dt_code);
      } else {
        code.addClass('text-output').unwrap().changeElementType('pre');
      }
    });
  
    // localize layout chunks to just output
    $('.layout-chunk').each(function(i, val) {
  
      // capture layout
      var layout = $(this).attr('data-layout');
  
      // apply layout to markdown level block elements
      var elements = $(this).children().not('d-code, pre.text-output, script');
      elements.each(function(i, el) {
        var layout_div = $('<div class="' + layout + '"></div>');
        if (layout_div.hasClass('shaded')) {
          var shaded_content = $('<div class="shaded-content"></div>');
          $(this).wrap(shaded_content);
          $(this).parent().wrap(layout_div);
        } else {
          $(this).wrap(layout_div);
        }
      });
  
  
      // unwrap the layout-chunk div
      $(this).children().unwrap();
    });
  
    // load distill framework
    load_distill_framework();
  
    // wait for window.distillRunlevel == 4 to do post processing
    function distill_post_process() {
  
      if (!window.distillRunlevel || window.distillRunlevel < 4)
        return;
  
      // hide author/affiliations entirely if we have no authors
      var front_matter = JSON.parse($("#distill-front-matter").html());
      var have_authors = front_matter.authors && front_matter.authors.length > 0;
      if (!have_authors)
        $('d-byline').addClass('hidden');
  
      // table of contents
      if (have_authors) // adjust border if we are in authors
        $('.d-toc').parent().addClass('d-article-with-toc');
  
      // strip links that point to #
      $('.authors-affiliations').find('a[href="#"]').removeAttr('href');
  
      // hide elements of author/affiliations grid that have no value
      function hide_byline_column(caption) {
        $('d-byline').find('h3:contains("' + caption + '")').parent().css('visibility', 'hidden');
      }
  
      // affiliations
      var have_affiliations = false;
      for (var i = 0; i<front_matter.authors.length; ++i) {
        var author = front_matter.authors[i];
        if (author.affiliation !== "&nbsp;") {
          have_affiliations = true;
          break;
        }
      }
      if (!have_affiliations)
        $('d-byline').find('h3:contains("Affiliations")').css('visibility', 'hidden');
  
      // published date
      if (!front_matter.publishedDate)
        hide_byline_column("Published");
  
      // document object identifier
      var doi = $('d-byline').find('h3:contains("DOI")');
      var doi_p = doi.next().empty();
      if (!front_matter.doi) {
        // if we have a citation and valid citationText then link to that
        if ($('#citation').length > 0 && front_matter.citationText) {
          doi.html('Citation');
          $('<a href="#citation"></a>')
            .text(front_matter.citationText)
            .appendTo(doi_p);
        } else {
          hide_byline_column("DOI");
        }
      } else {
        $('<a></a>')
           .attr('href', "https://doi.org/" + front_matter.doi)
           .html(front_matter.doi)
           .appendTo(doi_p);
      }
  
       // change plural form of authors/affiliations
      if (front_matter.authors.length === 1) {
        var grid = $('.authors-affiliations');
        grid.children('h3:contains("Authors")').text('Author');
        grid.children('h3:contains("Affiliations")').text('Affiliation');
      }
  
      // inject pre code styles (can't do this with a global stylesheet b/c a shadow root is used)
      $('d-code').each(function(i, val) {
        var style = document.createElement('style');
        style.innerHTML = 'pre code { padding-left: 10px; font-size: 12px; border-left: 2px solid rgba(0,0,0,0.1); } ' +
                          '@media(min-width: 768px) { pre code { padding-left: 18px; font-size: 14px; } }';
        if (this.shadowRoot)
          this.shadowRoot.appendChild(style);
      });
  
      // move appendix-bottom entries to the bottom
      $('.appendix-bottom').appendTo('d-appendix').children().unwrap();
      $('.appendix-bottom').remove();
  
      // clear polling timer
      clearInterval(tid);
  
      // show body now that everything is ready
      on_load_complete();
    }
  
    var tid = setInterval(distill_post_process, 50);
    distill_post_process();
  
  }
  
  function init_downlevel() {
  
    init_common();
  
     // insert hr after d-title
    $('.d-title').after($('<hr class="section-separator"/>'));
  
    // check if we have authors
    var front_matter = JSON.parse($("#distill-front-matter").html());
    var have_authors = front_matter.authors && front_matter.authors.length > 0;
  
    // manage byline/border
    if (!have_authors)
      $('.d-byline').remove();
    $('.d-byline').after($('<hr class="section-separator"/>'));
    $('.d-byline a').remove();
  
    // remove toc
    $('.d-toc-header').remove();
    $('.d-toc').remove();
    $('.d-toc-separator').remove();
  
    // move appendix elements
    $('h1.appendix, h2.appendix').each(function(i, val) {
      $(this).changeElementType('h3');
    });
    $('h3.appendix').each(function(i, val) {
      $(this).nextUntil($('h1, h2, h3')).addBack().appendTo($('.d-appendix'));
    });
  
  
    // inject headers into references and footnotes
    var refs_header = $('<h3></h3>');
    refs_header.text('References');
    $('#refs').prepend(refs_header);
  
    var footnotes_header = $('<h3></h3');
    footnotes_header.text('Footnotes');
    $('.footnotes').children('hr').first().replaceWith(footnotes_header);
  
    // move appendix-bottom entries to the bottom
    $('.appendix-bottom').appendTo('.d-appendix').children().unwrap();
    $('.appendix-bottom').remove();
  
    // remove appendix if it's empty
    if ($('.d-appendix').children().length === 0)
      $('.d-appendix').remove();
  
    // prepend separator above appendix
    $('.d-appendix').before($('<hr class="section-separator" style="clear: both"/>'));
  
    // trim code
    $('pre>code').each(function(i, val) {
      $(this).html($.trim($(this).html()));
    });
  
    // move posts-container right before article
    $('.posts-container').insertBefore($('.d-article'));
  
    $('body').addClass('downlevel');
  
    on_load_complete();
  }
  
  
  function init_common() {
  
    // jquery plugin to change element types
    (function($) {
      $.fn.changeElementType = function(newType) {
        var attrs = {};
  
        $.each(this[0].attributes, function(idx, attr) {
          attrs[attr.nodeName] = attr.nodeValue;
        });
  
        this.replaceWith(function() {
          return $("<" + newType + "/>", attrs).append($(this).contents());
        });
      };
    })(jQuery);
  
    // prevent underline for linked images
    $('a > img').parent().css({'border-bottom' : 'none'});
  
    // mark non-body figures created by knitr chunks as 100% width
    $('.layout-chunk').each(function(i, val) {
      var figures = $(this).find('img, .html-widget');
      if ($(this).attr('data-layout') !== "l-body") {
        figures.css('width', '100%');
      } else {
        figures.css('max-width', '100%');
        figures.filter("[width]").each(function(i, val) {
          var fig = $(this);
          fig.css('width', fig.attr('width') + 'px');
        });
  
      }
    });
  
    // auto-append index.html to post-preview links in file: protocol
    // and in rstudio ide preview
    $('.post-preview').each(function(i, val) {
      if (window.location.protocol === "file:")
        $(this).attr('href', $(this).attr('href') + "index.html");
    });
  
    // get rid of index.html references in header
    if (window.location.protocol !== "file:") {
      $('.distill-site-header a[href]').each(function(i,val) {
        $(this).attr('href', $(this).attr('href').replace("index.html", "./"));
      });
    }
  
    // add class to pandoc style tables
    $('tr.header').parent('thead').parent('table').addClass('pandoc-table');
    $('.kable-table').children('table').addClass('pandoc-table');
  
    // add figcaption style to table captions
    $('caption').parent('table').addClass("figcaption");
  
    // initialize posts list
    if (window.init_posts_list)
      window.init_posts_list();
  
    // implmement disqus comment link
    $('.disqus-comment-count').click(function() {
      window.headroom_prevent_pin = true;
      $('#disqus_thread').toggleClass('hidden');
      if (!$('#disqus_thread').hasClass('hidden')) {
        var offset = $(this).offset();
        $(window).resize();
        $('html, body').animate({
          scrollTop: offset.top - 35
        });
      }
    });
  }
  
  document.addEventListener('DOMContentLoaded', function() {
    if (is_downlevel_browser())
      init_downlevel();
    else
      window.addEventListener('WebComponentsReady', init_distill);
  });
  
  </script>
  
  <!--/radix_placeholder_distill-->
  <script src="2020-04-30-coronavirus_files/jquery-1.11.3/jquery.min.js"></script>
  <script src="2020-04-30-coronavirus_files/bowser-1.9.3/bowser.min.js"></script>
  <script src="2020-04-30-coronavirus_files/webcomponents-2.0.0/webcomponents.js"></script>
  <script src="2020-04-30-coronavirus_files/distill-2.2.21/template.v2.js"></script>
  <!--radix_placeholder_site_in_header-->
  <!--/radix_placeholder_site_in_header-->


</head>

<body class="layout-page">

<!--radix_placeholder_front_matter-->

<script id="distill-front-matter" type="text/json">
{"title":"Dinâmica do coronavirus em Portugal","authors":[{"author":"Humberto Silva","authorURL":"#","affiliation":"&nbsp;","affiliationURL":"#"}],"publishedDate":"2020-04-30T00:00:00.000+01:00","citationText":"Silva, 2020"}
</script>

<!--/radix_placeholder_front_matter-->
<!--radix_placeholder_navigation_before_body-->
<!--/radix_placeholder_navigation_before_body-->
<!--radix_placeholder_site_before_body-->
<!--/radix_placeholder_site_before_body-->

<div class="d-title">
<h1>Dinâmica do coronavirus em Portugal</h1>

</div>

<div class="d-byline">
  Humberto Silva  
  
<br/>2020-04-30
</div>

<div class="d-article">
<h3 class="d-toc-header">Table of Contents</h3>
<nav class="d-toc" id="TOC">
<ul>
<li><a href="#introdução">Introdução</a></li>
<li><a href="#como-é-possível-aos-epidemiologistas-estimarem-o-grau-de-contágio-do-vírus-e-como-a-epidemia-evolui">“Como é possível aos epidemiologistas estimarem o grau de contágio do vírus e como a epidemia evolui?”</a></li>
<li><a href="#por-que-é-tão-importante-criarmos-modelos">“Por que é tão importante criarmos modelos?”</a></li>
<li><a href="#em-que-fase-da-epidemia-estamos-em-portugal-agora">“Em que fase da epidemia estamos em Portugal agora? “</a></li>
<li><a href="#modelação-dos-dados">Modelação dos dados</a></li>
<li><a href="#estimativa-de-r0">Estimativa de R0</a></li>
<li><a href="#bibliografia-consultada">Bibliografia consultada</a></li>
</ul>
</nav>
<hr class="d-toc-separator"/>
<h2 id="introdução">Introdução</h2>
<p>Este post foi feito para fins didacticos e pretende ajudar a entender melhor como é possível construir um modelo matemático para estudar a evolução da doença Covid19, provocada pelo vírus SARS-CoV2, e aplicar esse modelo ao caso português. Surgiu na sequência de alguma pesquisa e da leitura do seguinte post <a href="https://blog.ephorie.de/epidemiology-how-contagious-is-novel-coronavirus-2019-ncov?fbclid=IwAR35_eyO1Ry6Bru04WKKPNv7mxt5rhNT_liU6QlEqJ8u-BrOZoVHxxJ0" class="uri">https://blog.ephorie.de/epidemiology-how-contagious-is-novel-coronavirus-2019-ncov?fbclid=IwAR35_eyO1Ry6Bru04WKKPNv7mxt5rhNT_liU6QlEqJ8u-BrOZoVHxxJ0</a> . Antes de mais nada, a minha formação académica é em Química e Biotecnologia, por isso tenho algumas bases científicas, contudo não sou especialista em epidemiologia. Talvez devido a esse facto, resolvi aprender a trabalhar com o software R e aprofundar os meus conhecimentos sobre esta doença. Este trabalho não se destina a fazer nenhuma previsão, nem ser uma ferramenta de tomada de decisões, sendo apenas uma primeira abordagem (imperfeita) de aproximação à realidade, destinando-se apenas a ilustrar alguns conceitos científicos de estatística, epidemiologia e modelação. Para a metodologia escolhi usar o software R para os cálculos estatísticos e fazer modelação dos dados. Portanto, a primeira pergunta é:</p>
<h2 id="como-é-possível-aos-epidemiologistas-estimarem-o-grau-de-contágio-do-vírus-e-como-a-epidemia-evolui">“Como é possível aos epidemiologistas estimarem o grau de contágio do vírus e como a epidemia evolui?”</h2>
<p>Para responder a esta questão a abordagem clássica é através de modelos que tentam simular a realidade e assim prever a evolução de uma determinada epidemia, ajudando dessa forma na tomada de decisões informadas sobre estratégias de saúde pública, ou outras, de combate à sua propagação (medidas de quarentena, isolamento social, higienização, vacinação, etc).</p>
<p>Existem diversos modelos disponíveis, porém aqui vamos usar o modelo SIR, talvez um dos mais populares (poderá consultar mais informação sobre diversos modelos existentes nesta página <a href="https://en.wikipedia.org/wiki/Compartmental_models_in_epidemiology" class="uri">https://en.wikipedia.org/wiki/Compartmental_models_in_epidemiology</a>). Os dados estatísticos relativos ao número de pessoas infectadas, que usaremos provêm das autoridades oficiais portuguesas, a Direcção Geral de Saúde (DGS), e podem ser consultados aqui (<a href="https://covid19.min-saude.pt/relatorio-de-situacao/" class="uri">https://covid19.min-saude.pt/relatorio-de-situacao/</a>). As análises adicionais serão minhas.</p>
<h2 id="por-que-é-tão-importante-criarmos-modelos">“Por que é tão importante criarmos modelos?”</h2>
<p>A saúde e a economia são duas faces de qualquer epidemia. Por um lado, precisamos salvar vidas e, por outro, precisamos manter nossos empregos, serviços sociais e todas as atividades que precisamos para sobreviver (agricultura, indústria, serviços e outras). Precisamos de ter estratégias para alcançarmos um equilíbrio entre a saúde e economia. Na minha opinião, numa primeira fase deveremos fazer um esforço para salvar vidas. Portanto, as medidas de isolamento social devem ser tão restritivas quanto as necessárias para evitar o colapso do sistema de saúde, mas também não as poderemos prolongar indefinidamente no tempo ou provocaremos uma crise económica com consequências também graves para a sociedade. Numa segunda fase, deveremos retomar as actividades económicas numa situação de maior controlo das variáveis que influenciam a transmissão do vírus (nomeadamente o R0). Uma vez que poderemos ter novamente um aumento de casos quando as medidas de quarentena são levantadas. Quanto à imunidade de grupo, estudos estimam que esta se atinge quando, pelo menos, cerca de 60% da população fica imunizada contra um agente infeccioso (mas ainda decorrem investigações para elucidar esta questão quanto ao caso da Covid19). Enquanto não existir uma vacina ou adquirirmos a imunidade de grupo necessitamos de continuar vigilantes quanto à progressão da doença, daí a necessidade destes modelos, para tomarmos decisões informadas. Surge então a questão seguinte:</p>
<h2 id="em-que-fase-da-epidemia-estamos-em-portugal-agora">“Em que fase da epidemia estamos em Portugal agora? “</h2>
<p>O primeiro passo será analisarmos os casos confirmados acumulados no tempo e para tal precisamos encontrar uma fonte confiável disponível. Como os dados da DGS estão em arquivos PDF no seu website, precisamos de uma solução melhor para adquirir rapidamente os dados de maneira automática. A solução que podemos usar é recorrer a uma tabela que contenha os mesmos dados mas que está em código html, pelo que recorri à seguinte fonte: <a href="https://pt.wikipedia.org/wiki/Pandemia_de_COVID-19_em_Portugal#Evolu%C3%A7%C3%A3o_dos_casos" class="uri">https://pt.wikipedia.org/wiki/Pandemia_de_COVID-19_em_Portugal#Evolu%C3%A7%C3%A3o_dos_casos</a> ). Com algum código em R podemos selecionar os dados de interesse (código é fornecido em anexo). Outra solução, será adquirimos os dados em um arquivo (formato csv ou txt) ou inserirmos os mesmos manualmente no código, mas não vou desenvolver este tema mais aqui pois existem diversos tutoriais sobre o software R para quem quiser aprofundar estes conhecimentos. Ter em atenção que caso existam alterações nas páginas de onde retiramos on-line a informação poderemos ter de reajustar o código. Então visualizando os dados graficamente:</p>
<div class="layout-chunk" data-layout="l-body">
<p><img src="2020-04-30-coronavirus_files/figure-html5/infected-1.png" width="624" /></p>
</div>
<p>O gráfico à esquerda é o total acumulado de pessoas infectadas ao longo do tempo (em dias desde o início do primeiro caso detectado) e à direita o mesmo gráfico, mas com uma escala logarítmica no eixo y (um gráfico log-linear). No segundo gráfico parece bastante claro que a curva está a “aplanar”, mostrando que em Portugal no momento actual terminamos o crescimento exponencial, ou seja, a taxa de crescimento é muito mais lenta agora. Veremos mais detalhadamente esta questão adiante.</p>
<h1 id="modelação-dos-dados">Modelação dos dados</h1>
<p>Chegamos então à modelação dos dados com o modelo SIR, cuja ideia básica é bastante simples. Existem três grupos de pessoas: aqueles que são saudáveis, mas susceptíveis à doença (S), os infectados (I) e as pessoas que se recuperaram (R): Para modelar a dinâmica do surto, precisamos de três equações diferenciais, uma para a mudança em cada grupo, onde é o parâmetro que controla a transição entre S e I e que controla a transição entre I e R:</p>
<figure>
<img src="https://www.lewuathe.com/assets/img/posts/2020-03-11-covid-19-dynamics-with-sir-model/sir.png" title="Modelo SIR" alt="Modelo SIR" /><figcaption>Modelo SIR</figcaption>
</figure>
<p>Source: wikipedia</p>
<p>O modelo pode ser representado por:</p>
<p><span class="math display">\[\frac{dS}{dt} = - \frac{\beta I S}{N}\]</span></p>
<p><span class="math display">\[\frac{dI}{dt} = \frac{\beta I S}{N}- \gamma I\]</span></p>
<p><span class="math display">\[\frac{dR}{dt} = \gamma I\]</span></p>
Inserindo as equações no modelo temos:
<div class="layout-chunk" data-layout="l-body">

</div>
<p>Inserimos as equações anteriores no modelo e de seguida precisamos de duas funções: uma para resolver as equações e outra para optmizar. Para a primeira usaremos a função “Ode” do pacote “deSolve” (CRAN) e para a optimização usaremos a ferramenta de base do R, ou seja, um método de minimização da soma da diferença quadrática entre o número de infectados e o número de casos previstos pelo modelo, ao longo do tempo (t):</p>
<p><span class="math display">\[RSS(\beta, \gamma) = \sum_{t} \left( I(t)-\^{I}(t) \right)^2\]</span></p>
<p>Resolvendo, obtêm-se convergência (indicada pelo software) e os seguintes parâmetros e .</p>
<p>Após uma prévia análise exploratória dos dados escolhemos apenas os pontos que pertencem a uma fase de crescimento exponencial até ao dia 20-03-2010.<br />
Escolhemos apenas estes dias porque sabemos da literatura que este modelo não integra as variáveis de distanciamento social que tomamos em Portugal em 16-03-2020, com o fecho das escolas, e depois em 18-03-2020, foi decretado o “Estado de Emergência”, além das medidas de higienização. Assim vamos estimar por excesso (obviamente) numa situação hipotética em que nada teria sido feito para evitar a progressão dos contágios. Podemos então fazer a representação gráfica:</p>
<div class="layout-chunk" data-layout="l-body">
<p><img src="2020-04-30-coronavirus_files/figure-html5/pressure-1.png" width="624" /><img src="2020-04-30-coronavirus_files/figure-html5/pressure-2.png" width="624" /></p>
</div>
<p>Observando os gráficos tal como previsto temos um bom ajuste dos dados reais à curva prevista pelo modelo. Assim, temos uma primeira aproximação à realidade e permite estimar alguns coeficientes. Num próximo post vamos tentar usar um modelo mais realista. Devemos também ter em conta que uma “curva epidémica” deve ser feita com as “datas de início dos sintomas” (tal como podemos verificar nos boletins oficiais) e aqui estamos a usar os casos confirmados por não termos outros dados. Outro factor é que a qualidade dos dados é muito importante para a qualidade do modelo.</p>
<h1 id="estimativa-de-r0">Estimativa de R0</h1>
<p>Agora poderemos extrair algumas estatísticas importantes. Um dos coeficientes é o chamado número básico de reprodução ou taxa básica de reprodução, R0 (“R nought” em inglês) que mostra basicamente quantas pessoas saudáveis são infectadas por uma pessoa doente em média (número médio de contágios):</p>
<div class="layout-chunk" data-layout="l-body">
<pre><code>
     R0 
1.98384 </code></pre>
<pre><code>
         I
45 1505232</code></pre>
<pre><code>
[1] 30104.65</code></pre>
</div>
<p>Assim, o R0 é estimado em 1,9 na fase inicial da epidemia no país, o que é consistente com o número que muitos pesquisadores e a OMS estimaram sendo aproximado do valor do SARS, Influenza ou Ébola. Existem diversos valores estimados que vão desde 1,4 até 3,5 para este parâmetro (<a href="https://www.worldometers.info/coronavirus/#repro" class="uri">https://www.worldometers.info/coronavirus/#repro</a>). De notar ainda que este R0 vem diminuindo ao longo do tempo passando a designar-se Rt ou Re (R efectivo), senbdo neste momento inferior a 1 segundo a DGS (pode variar de região para região). Além disso, de acordo com este modelo, o pico da epidemia seria alcançado em torno de 16-04-2020 (45 dias após o início). Como já referido a curva epidémica deverá ser construída com a data de início de sintomas e não de casos laboratoriais confirmados, pelo que podemos considerar uma média de 7 dias entre o início de sintomas e detecção laboratorial, logo se retirarmos 7 dias, terá sido na primeira semana de Abril, também não muito longe de algumas informações oficiais. Neste modelo hipotético a extensão da epidemia seria cerca de 1,5 milhões de pessoas infectadas e cerca de 30000 óbitos (assumindo taxa de mortalidade de 2%), o que claramente está sobrestimado. Como discutido anteriormente, este número está estimado para o pior cenário possível, sem quaisquer medidas, assumindo um modelo deterministico aleatório de transmissão. Isto pode dever-se ao modelo ser demasiado simplista por não incluir as variáveis de distanciamento social e/ou de outras medidas tomadas (portanto, estes números são muito altos). Outro factor que podemos ter é que existem muitos casos assintomáticos e estes nunca foram testados. Só saberemos quantas pessoas estiveram realmente expostas ao vírus através de testes serológicos à população. Portanto, não entremos em pânico, vamos tentar criar um modelo melhor para o caso português, num próximo post.</p>
<h1 id="bibliografia-consultada">Bibliografia consultada</h1>
<p><a href="https://www.nytimes.com/2020/04/23/world/europe/coronavirus-R0-explainer.html" class="uri">https://www.nytimes.com/2020/04/23/world/europe/coronavirus-R0-explainer.html</a> <a href="https://covid19.min-saude.pt/relatorio-de-situacao/" class="uri">https://covid19.min-saude.pt/relatorio-de-situacao/</a> <a href="https://wikiciencias.casadasciencias.org/wiki/index.php/Modelo_SIR_em_epidemiologia" class="uri">https://wikiciencias.casadasciencias.org/wiki/index.php/Modelo_SIR_em_epidemiologia</a> <a href="https://wwwnc.cdc.gov/eid/article/26/7/20-0282_article" class="uri">https://wwwnc.cdc.gov/eid/article/26/7/20-0282_article</a> <a href="https://www.worldometers.info/coronavirus/#repro" class="uri">https://www.worldometers.info/coronavirus/#repro</a></p>
<!--radix_placeholder_article_footer-->
<!--/radix_placeholder_article_footer-->
</div>

<div class="d-appendix">
</div>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

<!--radix_placeholder_site_after_body-->
<!--/radix_placeholder_site_after_body-->
<!--radix_placeholder_appendices-->
<div class="appendix-bottom">
<h3 id="updates-and-corrections">Corrections</h3>
<p>If you see mistakes or want to suggest changes, please <a href="https://github.com/science4u/science4u.github.io/tree/master/_posts/design/issues/new">create an issue</a> on the source repository.</p>
<h3 id="reuse">Reuse</h3>
<p>Text and figures are licensed under Creative Commons Attribution <a rel="license" href="https://creativecommons.org/licenses/by-sa/4.0/">CC BY-SA 4.0</a>. Source code is available at <a href="https://github.com/science4u/science4u.github.io/tree/master/_posts/design/">https://github.com/science4u/science4u.github.io/tree/master/_posts/design/</a>, unless otherwise noted. The figures that have been reused from other sources don't fall under this license and can be recognized by a note in their caption: "Figure from ...".</p>
</div>
<!--/radix_placeholder_appendices-->
<!--radix_placeholder_navigation_after_body-->
<!--/radix_placeholder_navigation_after_body-->

</body>

</html>
